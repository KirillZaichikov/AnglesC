# Общий метод углов

Здесь представлен алгоритм вычисления минимального угла между подпространсвами E^{cu} и E^{ss}.
Алгоритм допускает разные размерности этих подпространств, однако прямая сумма этих подпространств должна совпадать с R^{n}, где *n -- размерность динамической системы*.

## Зачем нужен

Алгоритм проверяет непрерывность (от точки на аттракторе) разбиения касательного пространства на два линейных подпространства, что является одним из условий псевдогиперболичности.

## Как работает 

### 1 случай: dim(E^{cu}) =< n / 2
Итерируя линеаризованную систему вдоль траектории мы получим направление наибольшего растяжения, итерируя площадь натянутую на два произвольных вектора (не давая им вытянуться в одном направлении -- ортогонализуя по Грамму-Шмидту), то эти два вектора развернутся в направлении наибольшего растяжения площадей. Таким образом, мы можем получить k = dim(E^{cu}) базисных векторов пространства E^{cu}.

Для получения базисных векторов пространства N^{ss} (пространство ортогональное к E^{cu}) необходимо итерировать транспонированную линеаризованную систему вдоль траектории в обратном времении. Так как итерировать систему в обратном времени мы не можем (в обратном времени аттрактор становится репеллером, а из-за того, что вычисляем траекторию численно, то с инвариантного множества мы неизбежно сойдем), то для итераций в обратном времени необходимо запоминать траекторию, из-за чего алгоритм очень сложен по памяти.

Получив базисные вектора в каждой точке траектории необходимо посчитать матрицу скалярных произведений. Далее посчитаем сингулярные числа этой матрицы. Для поиска собственных чисел используется итерационный QR-алгоритм.

После этого посчитаем минимальный угол, как из pi / 2 вычесть арккосинус минимального сингулярного числа.

### 2 случай: dim(E^{ss}) > n / 2:

В этом случае для эконмии памяти мы будем считать другие вектора, а именно: в прямом времени базисные вектора к N^{cu}, в обратном времени базисные вектора к E^{ss}.

### TODO
- Сделать ввод параметров через json файлов
- Придумать ввод системы без ручного ввода в код
- Вместо кучи параметров передавать структуры
- Выделять память вне алгоритмов, для лучшей читаемости
